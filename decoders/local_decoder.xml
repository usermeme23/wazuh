<!--
  -  Custom decoders
  -  Created for Wazuh CI/CD project
-->

<!-- MikroTik декодеры -->
<decoder name="mikrotik">
  <prematch>^Mikrotik </prematch>
</decoder>

<decoder name="mikrotik-login">
  <parent>mikrotik</parent>
  <prematch>login </prematch>
  <regex offset="after_prematch">(\w+) for user (\S+) from (\S+) via (\S+)</regex>
  <order>status, user, srcip, protocol</order>
</decoder>

<!-- Windows декодеры -->
<decoder name="windows">
  <prematch>^Windows </prematch>
</decoder>

<decoder name="windows-login">
  <parent>windows</parent>
  <prematch>login </prematch>
  <regex offset="after_prematch">(\w+) for user (\S+) from (\S+)</regex>
  <order>status, user, srcip</order>
</decoder>

<!-- Ubuntu декодеры -->
<decoder name="ubuntu">
  <prematch>^Ubuntu</prematch>
</decoder>

<decoder name="ubuntu-login">
  <parent>ubuntu</parent>
  <prematch>login </prematch>
  <regex offset="after_prematch">(\w+) for user (\S+) from (\S+)</regex>
  <order>status, user, srcip</order>
</decoder>

<!-- YARA декодеры из документации -->
<decoder name="yara_decoder">
  <prematch>wazuh-yara:</prematch>
</decoder>

<decoder name="yara_decoder1">
  <parent>yara_decoder</parent>
  <regex>wazuh-yara: (\S+) - Scan result: (\S+) (\S+)</regex>
  <order>log_type, yara_rule, yara_scanned_file</order>
</decoder> 