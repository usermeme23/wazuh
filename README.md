# Wazuh - Правила и Декодеры

![CI Status](https://img.shields.io/badge/CI-passing-brightgreen)

Репозиторий содержит пользовательские правила и декодеры для системы безопасности Wazuh, а также автоматизированный CI/CD процесс для их проверки и развертывания.

## Структура репозитория

```
.
├── .github/workflows/     # Конфигурация GitHub Actions для CI/CD
├── decoders/              # Пользовательские декодеры
├── rules/                 # Пользовательские правила
├── docs/                  # Документация
├── scripts/               # Утилиты для тестирования и развертывания
└── tests/logs/            # Тестовые логи
```

## Быстрый старт

### Локальное тестирование

Для локального тестирования правил и декодеров используйте скрипт:

```bash
# Клонировать репозиторий
git clone <URL репозитория>
cd wazuh

# Запустить локальное тестирование
chmod +x scripts/run_local_tests.sh
./scripts/run_local_tests.sh
```

Скрипт автоматически:
1. Проверит синтаксис XML файлов
2. Сгенерирует тестовые логи
3. Запустит Wazuh в Docker-контейнере
4. Скопирует правила и декодеры в контейнер
5. Протестирует их с тестовыми логами

### Добавление новых правил и декодеров

Полное руководство по добавлению новых правил и декодеров доступно в [Руководстве разработчика](docs/developer-guide.md).

Краткая инструкция:

1. Создайте новую ветку для ваших изменений
2. Добавьте новый декодер в `decoders/local_decoder.xml`
3. Добавьте новое правило в `rules/local_rules.xml`
4. Протестируйте локально с помощью `./scripts/run_local_tests.sh`
5. Отправьте Pull Request

## CI/CD процесс

Репозиторий настроен с автоматическим CI/CD процессом, который запускается при:
- Пуш-коммитах в основную ветку
- Создании Pull Request
- Изменении файлов в директориях `rules/`, `decoders/`, `scripts/`

### Что проверяет CI/CD

1. **Валидация XML**: проверка синтаксиса всех XML файлов
2. **Тестирование Wazuh**: запуск Wazuh и тестирование правил и декодеров с логами
3. **Уведомления**: отправка уведомлений о результатах

### Уведомления о результатах CI/CD

Система настроена на автоматическую отправку уведомлений о результатах CI/CD на email chaladima08@gmail.com. 

Уведомления отправляются при каждом запуске процесса CI/CD и содержат информацию о результатах проверки XML-файлов и тестирования Wazuh.

Для изменения email получателя уведомлений необходимо отредактировать файл `.github/workflows/ci.yml` в разделе `notify`.

## Документация

- [Руководство разработчика](docs/developer-guide.md) - инструкции по добавлению новых правил и декодеров
- [Интеграция с системами мониторинга](docs/monitoring-integration.md) - настройка мониторинга статуса правил и CI/CD

## Инструменты

Репозиторий включает следующие инструменты для упрощения разработки:

- `scripts/generate_test_logs.sh` - генерация тестовых логов для различных систем
- `scripts/run_local_tests.sh` - локальное тестирование правил и декодеров
- `pre-commit-check.sh` - проверка правил перед коммитом (используется git hook)

## Лицензия

Данный проект распространяется под лицензией GPLv2. 